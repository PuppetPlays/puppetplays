<!DOCTYPE html>
<html lang="fr">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>{{ title ?? 'Document PDF' }}</title>
		<style>
			/* Reset básico */
			* {
				box-sizing: border-box;
			}

			body,
			html {
				padding: 0;
				margin: 0;
				font-family: "Fira Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
				font-size: 14px;
				line-height: 1.4;
				color: #1a1b45;
				background-color: white;
			}

			/* Layout principal */
			.container {
				max-width: 1000px;
				margin: 0 auto;
				padding: 25px 15px;
			}

			/* Header de la obra */
			.work-header {
				text-align: center;
				margin-bottom: 25px;
				border-bottom: 2px solid #d9d9e0;
				padding-bottom: 20px;
			}

			.work-title {
				font-size: 26px;
				font-family: "PT Serif", "Georgia", "Times New Roman", serif;
				margin: 0 0 12px;
				color: #2037b1;
				line-height: 1.2;
			}

			.work-meta {
				font-size: 15px;
				font-weight: 500;
				margin: 0;
				color: #1a1b45;
				line-height: 1.3;
			}

			.pipe-separator {
				color: #b3b3c1;
				margin: 0 6px;
				font-size: 14px;
			}

			/* Imagen de portada - más grande, sin bordes ni background */
			.cover-image {
				width: 160px;
				height: 210px;
				overflow: hidden;
				position: relative;
			}

			.cover-image img {
				position: absolute;
				top: 0;
				left: 0;
				width: 160px;
				height: 210px;
				object-fit: cover;
			}

			.cover-image .placeholder {
				width: 160px;
				height: 210px;
				background-color: transparent;
				margin: 0 auto;
				display: flex;
				align-items: center;
				justify-content: center;
				color: #999;
				font-size: 11px;
				text-align: center;
			}

			/* Secciones principales */
			.content-section {
				margin-bottom: 16px;
			}

			.section-title {
				font-size: 14px;
				font-weight: 600;
				color: #2037b1;
				margin: 0 0 8px;
				text-transform: uppercase;
				letter-spacing: 0.5px;
			}

			.section-content {
				font-size: 13px;
				line-height: 1.5;
				text-align: justify;
			}

			/* Notice y Résumé destacados */
			.highlighted-section {
				background-color: #f8f9fa;
				border-left: 3px solid #2037b1;
				padding: 12px;
				margin: 12px 0;
				border-radius: 0 4px 4px 0;
			}

			/* Metadatos con diseño en tabla simple */
			.metadata-table {
				width: 100%;
				border-collapse: collapse;
				margin: 15px 0;
				background-color: #f8f9fa;
				border: 1px solid #e0e0e0;
				border-radius: 6px;
			}

			.metadata-table td {
				padding: 8px 10px;
				border-bottom: 1px solid #e8e8e8;
				vertical-align: top;
			}

			.metadata-table tr:last-child td {
				border-bottom: none;
			}

			.metadata-label {
				font-weight: 700;
				color: #2037b1;
				text-transform: uppercase;
				letter-spacing: 0.5px;
				font-size: 10px;
				width: 120px;
				background-color: white;
				border-radius: 3px;
			}

			.metadata-value {
				color: #1a1b45;
				font-size: 11px;
				line-height: 1.3;
			}

			/* Información de primera representación */
			.performance-info {
				background-color: #f0f0f3;
				border: 1px solid #b3b3c1;
				border-radius: 4px;
				padding: 12px;
				margin: 15px 0;
				text-align: center;
			}

			.performance-label {
				font-weight: 600;
				color: #1a1b45;
				font-size: 11px;
				margin-bottom: 6px;
				text-transform: uppercase;
				letter-spacing: 0.8px;
			}

			/* Personajes */
			.characters-section {
				background-color: #f0f0f3;
				padding: 12px;
				margin: 15px 0;
				border-radius: 4px;
				border-left: 4px solid #b3b3c1;
			}

			.characters-label {
				font-weight: 700;
				color: #1a1b45;
				font-size: 10px;
				text-transform: uppercase;
				margin-bottom: 6px;
				letter-spacing: 0.5px;
			}

			.characters-content {
				font-size: 11px;
				color: #1a1b45;
				line-height: 1.4;
			}

			/* Separador visual */
			.visual-separator {
				height: 1px;
				background-color: #dee2e6;
				margin: 18px 0;
			}

			/* Enlaces */
			a {
				color: #2037b1;
				text-decoration: underline;
			}

			/* Párrafos */
			p {
				margin: 0 0 8px;
			}

			p:last-child {
				margin-bottom: 0;
			}
		</style>
	</head>
	<body>
		<div
			class="container">
			<!-- Header de la obra -->
			<header class="work-header">
				<h1 class="work-title">{{ title }}</h1>
				{% if entry.subtitle %}
					<h2 style="font-size: 18px; font-weight: 500; margin: 0 0 10px 0; color: #1a1b45;">{{ entry.subtitle }}</h2>
				{% endif %}

				<div class="work-meta">
					{% if entry.authors.all()|length > 0 %}
						<span class="work-authors">
							{% set authorsList = [] %}
							{% for author in entry.authors.all() %}
								{% set authorsList = authorsList|merge([author.title]) %}
							{% endfor %}
							{{ authorsList|join(', ') }}
						</span>
					{% endif %}

					{% if entry.mostRelevantDate %}
						{% if entry.authors.all()|length > 0 %}
							<span class="pipe-separator">|</span>
						{% endif %}
						<span class="work-date">{{ entry.mostRelevantDate }}</span>
					{% else %}
						{% if entry.authors.all()|length > 0 %}
							<span class="pipe-separator">|</span>
						{% endif %}
						<span class="work-date">{{ entry.compositionMaxDate ?? entry.compositionMinDate ?? 'dateNotAvailable'|t('site') }}</span>
					{% endif %}

					{% if entry.compositionPlace.all()|length > 0 %}
						<span class="pipe-separator">|</span>
						<span class="work-place">
							{% set place = entry.compositionPlace.one() %}
							{{ place.title }}
							{% if place.country.all()|length > 0 and place.country.one().title != place.title %}
								,
								{{ place.country.one().title }}
							{% endif %}
						</span>
					{% endif %}

					{% if entry.mainLanguage.all()|length > 0 %}
						<span class="pipe-separator">|</span>
						<span class="work-language">{{ entry.mainLanguage.one().title }}</span>
					{% endif %}

					<div style="margin-top: 6px; font-size: 13px;">
						{% if entry.formats.all()|length > 0 %}
							{% set formatsList = [] %}
							{% for format in entry.formats.all() %}
								{% set formatsList = formatsList|merge([format.title]) %}
							{% endfor %}
							<span>{{ formatsList|join(', ') }}</span>
						{% elseif entry.medias.one() %}
							<span>{{ entry.medias.one().title }}</span>
						{% else %}
							<span>{{ 'printed'|t('site') }}</span>
						{% endif %}

						{% if entry.pagesCount %}
							<span class="pipe-separator">|</span>
							<span>{{ entry.pagesCount }}
								{{ 'pages'|t('site') }}</span>
						{% endif %}
					</div>
				</div>
			</header>

			<!-- Contenido principal con tabla más simple -->
			<table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
				<tr>
					<td
						style="width: 180px; vertical-align: top; padding-right: 20px;">
						<!-- Imagen más grande sin bordes -->
						<div class="cover-image">
							{% set mainImage = entry.mainImage.one() %}
							{% if mainImage %}
								<img src="{{ mainImage.url }}" alt="{{ mainImage.title ?? entry.title }}" width="160" height="210">
							{% else %}
								<div class="placeholder">
									<div>Sin imagen<br>disponible</div>
								</div>
							{% endif %}
						</div>
					</td>
					<td
						style="vertical-align: top;">
						<!-- Metadatos en tabla simple para mejor compatibilidad PDF -->
						<table class="metadata-table">
							{% if entry.mainLanguage.one() %}
								<tr>
									<td class="metadata-label">{{ 'language'|t('site') }}</td>
									<td class="metadata-value">{{ entry.mainLanguage.one().title }}</td>
								</tr>
							{% endif %}

							{% if entry.genre %}
								<tr>
									<td class="metadata-label">{{ 'genre'|t('site') }}</td>
									<td class="metadata-value">{{ entry.genre }}</td>
								</tr>
							{% endif %}

							{% if entry.audience.one() %}
								<tr>
									<td class="metadata-label">{{ 'audience'|t('site') }}</td>
									<td class="metadata-value">{{ entry.audience.one().title }}</td>
								</tr>
							{% endif %}

							<tr>
								<td class="metadata-label">{{ 'notice'|t('site') }}</td>
								<td class="metadata-value">{{ custom.author }}</td>
							</tr>

							{% if entry.literaryTones.all()|length > 0 %}
								<tr>
									<td class="metadata-label">{{ 'literaryTones'|t('site') }}</td>
									<td class="metadata-value">
										{% set tones = [] %}
										{% for litTone in entry.literaryTones.all() %}
											{% set tones = tones|merge([litTone.title]) %}
										{% endfor %}
										{{ tones|join(', ') }}
									</td>
								</tr>
							{% endif %}

							{% if entry.animationTechniques.all()|length > 0 %}
								<tr>
									<td class="metadata-label">{{ 'animationTechniques'|t('site') }}</td>
									<td class="metadata-value">
										{% set techniquesList = [] %}
										{% for technique in entry.animationTechniques.all() %}
											{% set techniquesList = techniquesList|merge([technique.title]) %}
										{% endfor %}
										{{ techniquesList|join(', ') }}
									</td>
								</tr>
							{% endif %}

							{% if entry.conservationPlace.one() %}
								<tr>
									<td class="metadata-label">{{ 'conservation'|t('site') }}</td>
									<td class="metadata-value">{{ entry.conservationPlace.one().title }}</td>
								</tr>
							{% endif %}

							{% if entry.keywords.all()|length > 0 %}
								<tr>
									<td class="metadata-label">{{ 'keywords'|t('site') }}</td>
									<td class="metadata-value">
										{% set keywordsList = [] %}
										{% for keyword in entry.keywords.all() %}
											{% set keywordsList = keywordsList|merge([keyword.title]) %}
										{% endfor %}
										{{ keywordsList|join(', ') }}
									</td>
								</tr>
							{% endif %}

							{% if entry.theatricalTechniques %}
								<tr>
									<td class="metadata-label">{{ 'theatricalTechniques'|t('site') }}</td>
									<td class="metadata-value">
										{% set theatricalList = [] %}
										{% for technique in entry.theatricalTechniques %}
											{% set theatricalList = theatricalList|merge([technique.title ?? technique]) %}
										{% endfor %}
										{{ theatricalList|join(', ') }}
									</td>
								</tr>
							{% endif %}
						</table>
					</td>
				</tr>
			</table>

			<!-- Personajes en sección separada -->
			{% if entry.textCharacters.all()|length > 0 %}
				<div class="characters-section">
					<div class="characters-label">{{ 'characters'|t('site') }}</div>
					<div class="characters-content">
						{% set characterList = [] %}
						{% for character in entry.textCharacters.all() %}
							{% if character.type.handle == 'character' %}
								{% set characterName = character.nameInText %}
								{% if character.roles.all()|length > 0 %}
									{% set rolesList = [] %}
									{% for role in character.roles.all() %}
										{% set rolesList = rolesList|merge([role.title]) %}
									{% endfor %}
									{% set characterName = characterName ~ ' (' ~ rolesList|join(', ') ~ ')' %}
								{% endif %}
								{% set characterList = characterList|merge([characterName]) %}
							{% endif %}
						{% endfor %}
						{{ characterList|join(', ') }}
					</div>
				</div>
			{% endif %}

			<div class="visual-separator"></div>

			<!-- Contenido principal: Notice y Résumé -->
			<div>
				{% if entry.note %}
					<div class="content-section highlighted-section">
						<h2 class="section-title">{{ 'notice'|t('site') }}</h2>
						<div class="section-content">{{ entry.note }}</div>
					</div>
				{% endif %}

				{% if entry.abstract %}
					<div class="content-section highlighted-section">
						<h2 class="section-title">{{ 'abstract'|t('site') }}</h2>
						<div class="section-content">{{ entry.abstract|raw }}</div>
					</div>
				{% endif %}
			</div>

			<!-- Información de primera representación -->
			{% if entry.firstPerformancePlace.one() or entry.firstPerformanceDate or entry.firstPerformanceComplementaryInformation %}
				<div class="performance-info">
					<div class="performance-label">{{ 'firstPerformance'|t('site') }}</div>
					<div style="font-size: 12px; color: #1a1b45;">
						{% set hasPlace = entry.firstPerformancePlace.one() %}
						{% set hasDate = entry.firstPerformanceDate %}
						{% set hasExtraInfo = entry.firstPerformanceComplementaryInformation %}

						{% if hasPlace %}
							{% set place = entry.firstPerformancePlace.one() %}
							<span>{{ place.title }}
								{% if place.country.all()|length > 0 and place.country.one().title != place.title %},
									{{ place.country.one().title }}
								{% endif %}
							</span>
						{% endif %}

						{% if hasPlace and (hasDate or hasExtraInfo) %},
						{% endif %}

						{% if hasDate %}
							<span>{{ entry.firstPerformanceDate }}</span>
						{% endif %}

						{% if hasDate and hasExtraInfo %}
							-
						{% endif %}

						{% if hasExtraInfo %}
							<span>{{ entry.firstPerformanceComplementaryInformation|raw }}</span>
						{% endif %}
					</div>
				</div>
			{% endif %}

			<!-- Ediciones y publicaciones -->
			{% if entry.publication or entry.modernEdition or entry.onlineCopy %}
				<div class="visual-separator"></div>
				<div class="content-section">
					<h2 class="section-title">{{ 'publicationsAndTranslations'|t('site') }}</h2>
					<div style="background-color: #fafafa; padding: 12px; border-radius: 4px;">
						{% if entry.publication %}
							<div style="margin-bottom: 8px;">
								<div style="font-weight: 600; color: #595b78; font-size: 10px; text-transform: uppercase; margin-bottom: 4px;">{{ 'publication'|t('site') }}</div>
								<div style="font-size: 12px;">{{ entry.publication }}</div>
							</div>
						{% endif %}

						{% if entry.modernEdition %}
							<div style="margin-bottom: 8px;">
								<div style="font-weight: 600; color: #595b78; font-size: 10px; text-transform: uppercase; margin-bottom: 4px;">{{ 'modernEdition'|t('site') }}</div>
								<div style="font-size: 12px;">{{ entry.modernEdition }}</div>
							</div>
						{% endif %}

						{% if entry.onlineCopy %}
							<div style="margin-bottom: 8px;">
								<div style="font-weight: 600; color: #595b78; font-size: 10px; text-transform: uppercase; margin-bottom: 4px;">{{ 'onlineCopy'|t('site') }}</div>
								<div style="font-size: 12px;">
									<a href="{{ entry.onlineCopy }}">{{ entry.onlineCopy }}</a>
								</div>
							</div>
						{% endif %}

						{% if entry.translations %}
							<div style="margin-bottom: 8px;">
								<div style="font-weight: 600; color: #595b78; font-size: 10px; text-transform: uppercase; margin-bottom: 4px;">{{ 'translations'|t('site') }}</div>
								<div style="font-size: 12px;">{{ entry.translations }}</div>
							</div>
						{% endif %}
					</div>
				</div>
			{% endif %}
		</div>
	</body>
</html>
